#!/bin/bash

HOURS=$1
MACHINES=$2
JOB_NAME=${3-'HadoopJob'}      # Defaults to "HadoopJob"

CORES=`expr $MACHINES \\* 8`   # 8 cores per machine

if [[ $HOURS ]] && [[ $CORES ]]; then
  echo "rm -rf $HADOOP_LOG_DIR"
  rm -rf $HADOOP_LOG_DIR

  qsub $TACC_HADOOP/hadoop-templates/hadoop.job
else
  echo "Usage: $0 NUM_HOURS NUM_MACHINES JOB_NAME"
  echo "Example Usage: $0 1 3 HadoopWordCount"
fi
